<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GleeWorld - Spelman College Glee Club</title>
    <meta name="description" content="Official digital platform of the Spelman College Glee Club - 100+ years of musical excellence" />
    <meta name="author" content="Spelman College Glee Club" />

    <meta property="og:title" content="GleeWorld - Spelman College Glee Club" />
    <meta property="og:description" content="Official digital platform of the Spelman College Glee Club - 100+ years of musical excellence" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google.com https://www.gstatic.com https://www.googletagmanager.com https://cdn.gpteng.co; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob: https:; media-src 'self' https://*.supabase.co; connect-src 'self' *.sentry.io https://api.squareup.com https://app.squareup.com https://squareup.com https://api.squareup.com/v1/cdp/batch https://ecosystem-header.squarecdn.com *.squarecloudservices.com https://cdn.cookielaw.org/ https://*.onetrust.com/ https://browser-intake-datadoghq.com/ https://www.google.com https://www.gstatic.com https://*.supabase.co wss://*.supabase.co; frame-src 'self' https://www.google.com https://docs.google.com https://www.youtube.com https://youtube.com https://www.youtube-nocookie.com;">
    
    <!-- Favicon and PWA icons -->
    <link rel="icon" href="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png" type="image/png">
    <link rel="apple-touch-icon" href="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png">
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GleeWorld">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="GleeWorld">
    <meta name="msapplication-TileColor" content="#1e3a8a">
    <meta name="msapplication-TileImage" content="/lovable-uploads/80d39e41-12f3-4266-8d7a-b1d3621bbf58.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Graduate&family=Roboto:wght@300;400;500;700&family=Dancing+Script:wght@400;700&family=Playfair+Display:wght@400;600;700&family=Montserrat:wght@300;400;500;600;700;800;900&family=Open+Sans:wght@300;400;500;600;700;800&family=Lato:wght@300;400;700;900&family=Merriweather:wght@300;400;700;900&family=Raleway:wght@300;400;500;600;700;800;900&family=Oswald:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800;900&family=Cinzel:wght@400;500;600;700;800;900&family=Cormorant+Garamond:wght@300;400;500;600;700&family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Preload Bravura font for musical notation -->
    <link rel="preload" href="/fonts/Bravura.otf" as="font" type="font/otf" crossorigin>
    <script>
      // Debug Google Fonts loading
      console.log('Google Fonts loading...');
      
      // Check if fonts are loaded
      if (document.fonts) {
        document.fonts.ready.then(() => {
          console.log('All fonts loaded successfully');
          console.log('Available fonts:', Array.from(document.fonts.values()).map(f => f.family));
        });
        
        document.fonts.onloadingdone = (e) => {
          console.log('Font loading done:', e);
        };
        
        document.fonts.onloadingerror = (e) => {
          console.error('Font loading error:', e);
        };
      }
      
      // Test Dancing Script specifically
      setTimeout(() => {
        const testEl = document.createElement('div');
        testEl.style.fontFamily = 'Dancing Script, cursive';
        testEl.style.fontSize = '16px';
        testEl.textContent = 'Test';
        testEl.style.position = 'absolute';
        testEl.style.left = '-9999px';
        document.body.appendChild(testEl);
        
        const computedStyle = window.getComputedStyle(testEl);
        console.log('Dancing Script computed font-family:', computedStyle.fontFamily);
        
        document.body.removeChild(testEl);
      }, 1000);
    </script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('SW registered');
              
              // Check for updates every 60 seconds
              setInterval(() => {
                registration.update();
              }, 60000);
              
              // Listen for updates
              registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'activated') {
                    // Notify user of update
                    if (confirm('New version available! Reload to update?')) {
                      window.location.reload();
                    }
                  }
                });
              });
            })
            .catch(err => console.log('SW registration failed:', err));
        });
        
        // Handle controller change (new SW activated)
        let refreshing = false;
        navigator.serviceWorker.addEventListener('controllerchange', () => {
          if (!refreshing) {
            refreshing = true;
            window.location.reload();
          }
        });
      }
    </script>
  </body>
</html>
